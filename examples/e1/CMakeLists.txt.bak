FILE(GLOB mgcpp_SOURCES "*.cpp")

# mongoose does not compile with strict aliasing.
SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -fno-strict-aliasing")

IF(MG_ENABLE_DEBUG)
    ADD_DEFINITIONS(-DMG_ENABLE_DEBUG)
ELSE()
    ADD_DEFINITIONS(-DMG_DISABLE_STDIO)
ENDIF()

ADD_LIBRARY(mgcpp_static STATIC ${mgcpp_SOURCES})
SET_TARGET_PROPERTIES(mgcpp_static PROPERTIES OUTPUT_NAME mgcpp)
TARGET_LINK_LIBRARIES(mgcpp_static)
INSTALL(TARGETS mgcpp_static DESTINATION lib)

IF(ENABLE_SHARED_LIBS)
    ADD_LIBRARY(mgcpp_shared SHARED ${mgcpp_SOURCES})
    SET_TARGET_PROPERTIES(mgcpp_shared PROPERTIES OUTPUT_NAME mgcpp)
    TARGET_LINK_LIBRARIES(mgcpp_shared)
    INSTALL(TARGETS mgcpp_shared DESTINATION lib)
ENDIF()
